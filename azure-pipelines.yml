name: $(Date:yyyyMMdd)$(Rev:.r)

resources:
  repositories:
  - repository: github_repo
    type: github
    name: sazubarev/twitch-notifier-bot  # Ваш репозиторий
    endpoint: github-twitch-bot

trigger:
- main

schedules:
- cron: "*/15 * * * *"
  displayName: "Check Stream"
  branches:
    include: [main]

variables:
- group: twitch_bot_secrets

pool:
  vmImage: 'ubuntu-latest'

steps:
- checkout: github_repo  # Указываем репозиторий

- task: UsePythonVersion@0
  inputs:
    versionSpec: '3.9'

- script: |
    pip install -r requirements.txt
    python src/main.py
  env:
    TWITCH_CLIENT_ID: $(TWITCH_CLIENT_ID)
    TELEGRAM_TOKEN: $(TELEGRAM_BOT_TOKEN)